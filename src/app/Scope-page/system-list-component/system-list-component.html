<div class="system-list-container">
  <mat-accordion class="systems-accordion">
    <mat-expansion-panel
      *ngFor="let release of systems; let i = index"
      class="system-panel"
      [class.panel-animated]="true">

      <mat-expansion-panel-header class="system-header">
        <mat-panel-title class="system-title-wrapper">
          <div class="system-info">
            <strong class="system-name">{{ release.name }}</strong>
            <span class="status-badge" [ngClass]="getStatusClass(release.status)">
        {{ getStatusLabel(release.status) }}
      </span>
          </div>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <div class="panel-content">
        <div class="release-details">

          <!-- Planned Release -->
          <div class="detail-row">
            <mat-icon class="detail-icon">event</mat-icon>
            <div class="detail-content">
              <span class="detail-label">Planned Release</span>
              <span class="detail-value">{{ release.name }}</span>
            </div>
          </div>

          <!-- Release Candidate -->
          <div class="detail-row release-candidate-row">
            <mat-icon class="detail-icon">rocket_launch</mat-icon>
            <div class="detail-content detail-with-action">
              <span class="detail-label">Release Candidate</span>
              <div class="candidate-info">
                <span class="detail-value candidate-value">
                  {{ release.releaseCandidate || 'Not assigned' }}
                </span>
                <button
                  mat-raised-button
                  color="primary"
                  class="create-candidate-btn"
                  (click)="onCreateReleaseCandidate(release)">
                  <mat-icon>{{ release.releaseCandidate ? 'edit' : 'add' }}</mat-icon>
                  <span>{{ release.releaseCandidate ? 'Update' : 'Create' }}</span>
                </button>
              </div>
            </div>
          </div>

          <!-- Status Selector -->
          <div class="detail-row status-selector-row">
            <mat-icon class="detail-icon">flag</mat-icon>
            <div class="detail-content full-width">
              <span class="detail-label">Update Status</span>
              <mat-form-field appearance="outline" class="status-select-field">
                <mat-label>Select Status</mat-label>
                <mat-select
                  [(ngModel)]="release.status"
                  (selectionChange)="onStatusChange(release.plannedReleaseID, release.status!)">
                  <mat-option *ngFor="let option of statusOptions" [value]="option.value">
                    <span [ngClass]="getStatusClass(option.value)">{{ option.label }}</span>
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
        </div>
        <app-system-delete-form
          [plannedReleaseId]="release.plannedReleaseID"
          (delete)="deleteSystem.emit($event)">
        </app-system-delete-form>
      </div>
    </mat-expansion-panel>
  </mat-accordion>

  <div *ngIf="!systems || systems.length === 0" class="empty-state">
    <mat-icon class="empty-icon">inventory_2</mat-icon>
    <p class="empty-text">No planned releases added yet</p>
    <p class="empty-subtext">Add your first planned release to the release bundle below</p>
  </div>
</div>
